% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_afAFT.R
\name{fit_afAFT}
\alias{fit_afAFT}
\title{Additive Functional Accelerated Failure Time (afAFT) Models}
\usage{
fit_afAFT(
  data = NULL,
  y,
  delta,
  x,
  x_as_regex = FALSE,
  z = NULL,
  family = c("lognormal"),
  k = c(20, 20),
  s_grid = NULL,
  basis = c("cr", "cr"),
  basis_args = list()
)
}
\arguments{
\item{data}{Optional \code{data.frame} containing variables referenced by
\code{y}, \code{delta}, \code{x}, and \code{z}. If \code{NULL}, the
variables are looked up in the calling environment.}

\item{y}{Survival time variable. Either a character string (column name in
\code{data}) or an object name in the calling environment.}

\item{delta}{Censoring indicator (1 = event, 0 = right-censored).}

\item{x}{Functional covariate specification. Either:
\itemize{
\item A character vector of names to be column-bound into the wide
functional matrix \code{X}, or
\item A single regex/prefix (with \code{x_as_regex = TRUE}) used to
discover matching columns or objects.
}}

\item{x_as_regex}{Logical; if \code{TRUE} and \code{length(x) == 1}, treat
\code{x} as a regex/prefix and discover matching functional columns.}

\item{z}{Optional scalar covariates (may be \code{NULL}).  Typically a
character vector of column/object names.}

\item{k}{Integer vector of length 1 or 2. Basis dimensions for the
tensor-product smooth \code{ti(S, X, ...)}; recycled to length 2 if a
single integer is provided.}

\item{s_grid}{Optional numeric vector giving the functional grid
\eqn{s_1,\ldots,s_{n_S}} (must match \code{ncol(X)}). If \code{NULL}, an
equally spaced grid on [0, 1] is used.}

\item{basis}{Character vector of length 1 or 2 specifying the marginal
spline bases for \code{\link[mgcv]{ti}}.  Defaults to
\code{c("cr","cr")}.}
}
\value{
A fitted \code{\link[mgcv]{gam}} object with additional elements:
\itemize{
\item \code{X_names}, \code{Z_names}: variable names used.
\item \code{s_grid}: the functional grid employed.
\item \code{family_name}: chosen family label.
}
}
\description{
Fit an additive functional regression model for survival data using
\pkg{mgcv}, where the functional predictor \eqn{X(s)} enters the model
through an additive term of the form
\deqn{
  \int F\{X(s), s\}\, ds,
}
with an unknown bivariate smooth function \eqn{F(\cdot,\cdot)}.  This is
implemented using a tensor-product smooth over the functional covariate and
its domain.
}
\details{
Currently only the log-normal AFT model is supported (see \url{https://rdrr.io/cran/mgcv/man/cnorm.html}).
}
\examples{
\dontrun{
library(mgcv)
set.seed(1)
n <- 100; nS <- 50
dat <- data.frame(
  time = rexp(n, 0.1),
  status = rbinom(n, 1, 0.7),
  age = rnorm(n, 60, 8)
)
Xfun <- matrix(rnorm(n*nS), n, nS)
colnames(Xfun) <- paste0("X", 1:nS)
dat <- cbind(dat, Xfun)

fit <- fit_afAFT(
  data = dat, y = "time", delta = "status",
  x = "^X", x_as_regex = TRUE,
  z = "age")
summary(fit)
}

}
