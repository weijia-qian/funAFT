% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/optimize_lambda.R
\name{optimize_lambda}
\alias{optimize_lambda}
\title{Optimize the Smoothing Parameter (Lambda) via Generalized Cross-Validation (GCV)}
\usage{
optimize_lambda(
  lambda_grid,
  data = NULL,
  y,
  delta,
  x,
  x_as_regex = FALSE,
  z = NULL,
  family = c("lognormal", "loglogistic"),
  k = 20,
  s_grid = NULL,
  basis = c("bs", "ns"),
  basis_args = list()
)
}
\arguments{
\item{lambda_grid}{Numeric vector of candidate smoothing parameters.
Must have length â‰¥ 1. Each value is evaluated separately
by fitting a lfAFT model and computing its GCV.}

\item{data}{Optional \code{data.frame} containing all variables in the model.
If \code{NULL}, variables are searched in the calling environment.}

\item{y}{Character. Name of the variable for survival time.}

\item{delta}{Character. Name of the censoring indicator
(1 = observed, 0 = censored).}

\item{x}{Character vector or single regex/prefix pattern.
- If \code{x_as_regex = FALSE} (default), supply the exact column names
for the functional covariate.
- If \code{x_as_regex = TRUE} and \code{length(x) == 1}, all columns in
\code{data} (or objects in the environment) matching the pattern are used.}

\item{x_as_regex}{Logical. If \code{TRUE} and \code{length(x) == 1},
treat \code{x} as a regular expression or prefix to match
functional covariate columns.}

\item{z}{Optional character vector of scalar covariate names.
If \code{NULL}, the model includes no scalar covariates.}

\item{family}{Character; either \code{"lognormal"} or \code{"loglogistic"}.
Determines the error distribution of the AFT model.}

\item{k}{Integer; number of spline basis functions used to represent
\eqn{\beta(s)} (effective degrees of freedom for the functional coefficient).}

\item{s_grid}{Optional numeric vector of the same length as the number of
functional measurement points (\code{ncol(X)}). If \code{NULL},
assumes an equally spaced grid over [0, 1].}

\item{basis}{Character; one of \code{c("bs", "ns")}. Determines the spline
basis type used for the functional coefficient. Defaults to
\code{"bs"} (B-spline).}

\item{basis_args}{List of additional arguments passed to the spline basis
constructor (e.g., \code{degree = 3} for \code{bs},
or \code{intercept = FALSE}).}
}
\value{
A list with the following elements:
\describe{
\item{\code{lambda}}{Optimal smoothing parameter minimizing GCV.}
\item{\code{gcv}}{Numeric vector of GCV scores corresponding to
each candidate \code{lambda_grid} value (may contain \code{NA}s).}
\item{\code{grid}}{The input \code{lambda_grid}.}
\item{\code{best_index}}{Integer index of the selected optimal \code{lambda}.}
}
}
\description{
Evaluates a user-specified grid of smoothing parameters (\eqn{\lambda})
for the linear functional accelerated failure time (lfAFT) model and
selects the value that minimizes the generalized cross-validation (GCV) score.
}
\examples{
\dontrun{
# Define a candidate grid of smoothing parameters
lam_grid <- 10^seq(1, 4, length.out = 10)

# Evaluate GCV for each lambda (example with synthetic data)
opt <- optimize_lambda(lambda_grid = lam_grid,
                       data = mydata,
                       y = "Y", delta = "Delta",
                       x = "^X", x_as_regex = TRUE,
                       family = "lognormal",
                       k = 10)

plot(lam_grid, opt$gcv, type = "b", log = "x",
     xlab = "lambda", ylab = "GCV")
abline(v = opt$lambda, col = "red", lty = 2)
}
}
\seealso{
\code{\link{fit_lfAFT}} for model fitting with automatic
lambda selection, and \code{\link{fit_lfAFT_single_lambda}}
for fitting at a fixed \eqn{\lambda}.
}
