% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_lfAFT_single_lambda.R
\name{fit_lfAFT_single_lambda}
\alias{fit_lfAFT_single_lambda}
\title{Fit Linear Functional Accelerated Failure Time (lfAFT) Models with A Given Lambda}
\usage{
fit_lfAFT_single_lambda(
  data = NULL,
  y,
  delta,
  x,
  x_as_regex = FALSE,
  z = NULL,
  family = c("lognormal", "loglogistic"),
  s_grid = NULL,
  lambda,
  k = 20,
  basis = c("bs", "ns"),
  basis_args = list(),
  se = FALSE,
  bootstrap = FALSE,
  B = 500,
  boot_seed = NULL
)
}
\arguments{
\item{data}{Optional \code{data.frame} containing all variables in the model.
If \code{NULL}, variables are searched in the calling environment.}

\item{y}{Character. Name of the variable for survival time.}

\item{delta}{Character. Name of the censoring indicator
(1 = observed, 0 = censored).}

\item{x}{Character vector or single regex/prefix pattern.
- If \code{x_as_regex = FALSE} (default), supply the exact column names
for the functional covariate.
- If \code{x_as_regex = TRUE} and \code{length(x) == 1}, all columns in
\code{data} (or objects in the environment) matching the pattern are used.}

\item{x_as_regex}{Logical. If \code{TRUE} and \code{length(x) == 1},
treat \code{x} as a regular expression or prefix to match
functional covariate columns.}

\item{z}{Optional character vector of scalar covariate names.
If \code{NULL}, the model includes no scalar covariates.}

\item{family}{Character; either \code{"lognormal"} or \code{"loglogistic"}.
Determines the error distribution of the AFT model.}

\item{s_grid}{Optional numeric vector of the same length as the number of
functional measurement points (\code{ncol(X)}). If \code{NULL},
assumes an equally spaced grid over [0, 1].}

\item{lambda}{Numeric; smoothing parameter controlling the penalty on
roughness of \eqn{\beta(s)}.}

\item{k}{Integer; number of spline basis functions used to represent
\eqn{\beta(s)} (effective degrees of freedom for the functional coefficient).}

\item{basis}{Character; one of \code{c("bs", "ns")}. Determines the spline
basis type used for the functional coefficient. Defaults to
\code{"bs"} (B-spline).}

\item{basis_args}{List of additional arguments passed to the spline basis
constructor (e.g., \code{degree = 3} for \code{bs},
or \code{intercept = FALSE}).}

\item{se}{Logical. If \code{TRUE}, computes Wald standard errors and 95\\%
confidence intervals based on the inverse Hessian.}

\item{bootstrap}{Logical. If \code{TRUE}, computes percentile-based
bootstrap confidence intervals via subject-level
resampling.}

\item{B}{Integer; number of bootstrap replicates (default 500).}

\item{boot_seed}{Optional integer seed for reproducibility in bootstrapping.}
}
\value{
A list containing:
\describe{
\item{\code{beta0_hat}}{Estimated intercept.}
\item{\code{betaZ_hat}}{Estimated scalar covariate coefficients (if any).}
\item{\code{betaX_hat}}{Estimated functional coefficient curve
\eqn{\hat{\beta}(s)} evaluated on the supplied grid.}
\item{\code{sigma_hat}}{Estimated scale parameter.}
\item{\code{lp}}{Linear predictor values (\eqn{\hat{\mu}_i}).}
\item{\code{GCV}}{Generalized cross-validation score.}
\item{\code{se_*}}{Wald standard errors (if \code{se=TRUE}).}
\item{\code{*_ci_lower}, \code{*_ci_upper}}{Wald or bootstrap
95 \% confidence intervals.}
\item{\code{family, lambda, basis, kbasis, s_grid}}{Model specifications.}
\item{\code{convergence, value, message}}{Optimizer diagnostics.}
}
}
\description{
Fits a linear functional accelerated failure time (lfAFT) model
for right-censored survival outcomes with functional and scalar covariates
with a given smoothing parameter (\eqn{\lambda}).
}
\examples{
# Example with synthetic data
set.seed(1)
n <- 100; s <- seq(0, 1, length.out = 50)
beta_true <- sin(2 * pi * s)
X <- matrix(rnorm(n * 50), n, 50)
mu <- 1 + X \%*\% beta_true * 0.5
Y <- exp(mu + rnorm(n))
Delta <- rbinom(n, 1, 0.8)
dat <- data.frame(Y = Y, Delta = Delta, X)

fit <- fit_lfAFT(data = dat,
                 y = "Y", delta = "Delta",
                 x = "^X", x_as_regex = TRUE,
                 family = "lognormal",
                 lambda = 10, k = 10, se = TRUE)

plot(fit$s_grid, fit$betaX_hat, type = "l",
     xlab = "s", ylab = "Estimated beta(s)")
}
